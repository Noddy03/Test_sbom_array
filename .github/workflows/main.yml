 name: IoT Full SBOM Pipeline (Model 2 - Cdxgen-first, Build-before-scan, CycloneDX 1.5)

 on:
  workflow_dispatch:
    inputs:
      language:
        description: "Language filter (e.g. C++, Python, Java)"
        required: true
        default: "C++"

 permissions:
  contents: read
  security-events: write
  actions: read

 env:
  DEBIAN_FRONTEND: noninteractive
  CYCLONEDX_SPEC: "1.5"

 jobs:
  fetch_top_repos:
    runs-on: ubuntu-latest
    outputs:
      repo_list: ${{ steps.fetch.outputs.repo_list }}
    steps:
      - name: Install jq & gh
        run: |
          sudo apt-get update -y
          sudo apt-get install -y jq gh
      - name: Fetch repositories
        id: fetch
        env:
          LANG: ${{ github.event.inputs.language }}
          GH_TOKEN: ${{ github.token }}
        run: |
          set -euo pipefail
          RAW_Q="topic:iot language:$LANG fork:false archived:false"
          REPOS=$(gh api -X GET /search/repositories \
              --raw-field q="$RAW_Q" \
              --raw-field sort=stars \
              --raw-field order=desc \
              --raw-field per_page=100 \
              --jq '.items[].full_name' || true)
          if [ -z "$REPOS" ]; then
            RAW_Q="language:$LANG fork:false archived:false"
            REPOS=$(gh api -X GET /search/repositories \
                --raw-field q="$RAW_Q" \
                --raw-field sort=stars \
                --raw-field order=desc \
                --raw-field per_page=100 \
                --jq '.items[].full_name' || true)
          fi
          if [ -z "$REPOS" ]; then
              echo "repo_list=[]" >> $GITHUB_OUTPUT
              echo "No repositories found for query: $LANG"
          else
              echo "repo_list=$(echo $REPOS | jq -R . | jq -s .)" >> $GITHUB_OUTPUT
          fi

  sbom_scan:
    name: SBOM Scan - ${{ matrix.repo }}
    needs: fetch_top_repos
    if: needs.fetch_top_repos.outputs.repo_list != '[]'
    strategy:
      fail-fast: false
      matrix:
        repo: ${{ fromJson(needs.fetch_top_repos.outputs.repo_list) }}
    runs-on: ubuntu-latest
    env:
      GITHUB_SHA: ${{ github.sha }}
      GITHUB_REPOSITORY: ${{ matrix.repo }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          repository: ${{ matrix.repo }}
          ref: ${{ github.sha }}
          path: project-src
          fetch-depth: 0

      - name: Install tools and dependencies
        run: |
          sudo apt-get update -y
          sudo apt-get install -y wget curl build-essential git python3 python3-pip cmake ninja-build subversion default-jre
          pip3 install cyclonedx-bom sbomqs
          wget https://github.com/CycloneDX/cdxgen/releases/download/v9.6.0/cdxgen-linux-x64.tar.gz
          tar xvf cdxgen-linux-x64.tar.gz
          sudo cp cdxgen-linux-x64/cdxgen /usr/local/bin/cdxgen
          rm -rf cdxgen-linux-x64 cdxgen-linux-x64.tar.gz
          cdxgen --version

      - name: Detect build system and attempt build (Autobuild)
        id: build
        working-directory: project-src
        run: |
          set +e
          echo "Attempting build for ${{ matrix.repo }}"
          if [ -f "configure" ]; then
            echo "Running ./configure && make"
            ./configure > /dev/null 2>&1
            make -j$(nproc) > /dev/null 2>&1
          elif [ -f "Makefile" ]; then
            echo "Running make"
            make -j$(nproc) > /dev/null 2>&1
          elif [ -f "CMakeLists.txt" ]; then
            echo "Running cmake && make"
            cmake -B build -G "Ninja" -DCMAKE_BUILD_TYPE=Release . > /dev/null 2>&1
            cmake --build build -j$(nproc) > /dev/null 2>&1
          elif [ -f "build.sh" ]; then
            echo "Running build.sh"
            ./build.sh > /dev/null 2>&1
          else
            echo "No common build file found. Skipping build."
          fi
          set -e
          echo "Build finished (may have failed, continuing to scan)"

      - name: Generate SBOM (cdxgen)
        id: cdxgen
        working-directory: project-src
        run: |
          cdxgen -o cdxgen-sbom.json --spec-version 1.5 -t "${{ github.event.inputs.language }}" || true

      - name: Generate SBOM (trivy-fs)
        id: trivy
        working-directory: project-src
        run: |
          trivy fs -f cyclonedx --scanners rootfs --dependency-tree --enable-modules --full-scan --output trivy-fs.json . || true
      
      - name: Generate SBOM (syft)
        id: syft
        working-directory: project-src
        run: |
          syft packages dir:. -o cyclonedx-json > syft-sbom.json || true

      - name: Generate SBOM (conan)
        id: conan
        working-directory: project-src
        run: |
          if [ -f "conanfile.txt" ] || [ -f "conanfile.py" ]; then
            conan install . --output-folder=build --build=missing || true
            conan graph export --format=cyclonedx build/conan_graph.html --output=conan-sbom.json || true
          else
            echo "No conanfile found. Skipping conan scan."
            echo "{}" > conan-sbom.json
          fi

      - name: Merge and Enrich SBOMs (Fixed Timestamp Encoding)
        id: merge
        run: |
          set -euo pipefail
          # FIX: Re-encoded Python script to fix the 'metadata.timestamp' field 
          # from an integer timestamp to a valid ISO 8601 string (time.strftime('%Y-%m-%dT%H:%M:%SZ', time.gmtime()))
          echo aW1wb3J0IG9zLCBqc29uLCB1dWlkLCB0aW1lLCBoYXNobGliLCBzdWJwcm9jZXNzCgpST09UID0gInByb2plY3Qtc3JjIgpPVVQgPSBvcy5wYXRoLmpvaW4oUk9PVCwgIm1lcmdlZC1zYm9tLmpzb24iKQoKZGVmIGxvYWQocCk6CiAgICB0cnk6CiAgICAgICAgcmV0dXJuIGpzb24ubG9hZChvcGVuKHApKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4geyJjb21wb25lbnRzIjogW119CgpjZHggPSBsb2FkKG9zLnBhdGguam9pbihST09ULCAiY2R4Z2VuLXNib20uanNvbiIpKQp0cml2eSA9IGxvYWQob3MucGF0aC5qb2luKFJPT1QsICJ0cml2eS1mcy5qc29uIikpCnN5ZnQgPSBsb2FkKG9zLnBhdGguam9pbihST09ULCAic3lmdC1zYm9tLmpzb24iKSkKY29uYW4gPSBsb2FkKG9zLnBhdGguam9pbihST09ULCAiY29uYW4tc2JvbS5qc29uIikpCmV4dHJhX2ZpbGVzID0gWyJjeWNsb25lZHgtc2JvbS5qc29uIiwgImJvbS5qc29uIl0KZXh0cmEgPSBbXQpmb3IgZWYgaW4gZXh0cmFfZmlsZXM6CiAgICBwID0gb3MucGF0aC5qb2luKFJPT1QsIGVmKQogICAgaWYgb3MucGF0aC5leGlzdHMocCk6CiAgICAgICAgdG1wID0gbG9hZChwKQogICAgICAgIGlmIHRtcC5nZXQoImNvbXBvbmVudHMiKToKICAgICAgICAgICAgZXh0cmEuZXh0ZW5kKHRtcC5nZXQoImNvbXBvbmVudHMiLCBbXSkpCgptZXJnZWQgPSBbXQpzZWVuID0gc2V0KCkKCmRlZiBrZXlfb2YoYyk6CiAgICBwdXJsID0gYy5nZXQoInB1cmwiKQogICAgaWYgcHVybDoKICAgICAgICByZXR1cm4gKCJwdXJsIiwgcHVybCkKICAgIHJldHVybiAoYy5nZXQoIm5hbWUiKSwgYy5nZXQoInZlcnNpb24iKSkKCmRlZiBhZGRfY29tcG9uZW50KGMpOgogICAgaWYgbm90IGMuZ2V0KCJuYW1lIik6CiAgICAgICAgY1sibmFtZSJdID0gYy5nZXQoInB1cmwiLCAidW5rbm93biIpLnNwbGl0KCIvIilbLTFdCiAgICBpZiBub3QgYy5nZXQoInZlcnNpb24iKToKICAgICAgICBjWyJ2ZXJzaW9uIl0gPSBvcy5lbnZpcm9uLmdldCgiR0lUSFVCX1NIQSIsICIwIikKICAgIGlmIG5vdCBjLmdldCgidHlwZSIpOgogICAgICAgIGNbInR5cGUiXSA9ICJmaWxlIiBpZiBjLmdldCgibmFtZSIsICIiKS5lbmRzd2l0aCgoJy5jJywnLmgnLCcuY3BwJywnLnB5JykpIGVsc2UgImxpYnJhcnkiCiAgICBpZiBub3QgYy5nZXQoInB1cmwiKToKICAgICAgICBzYWZlX25hbWUgPSBjWyJuYW1lIl0ucmVwbGFjZSgiICIsICJfIikKICAgICAgICBjWyJwdXJsIl0gPSBmInBrZzpnZW5lcmljL3tzYWZlX25hbWV9QHtjWyd2ZXJzaW9uJ119IgogICAgaWYgbm90IGMuZ2V0KCJib20tcmVmIik6CiAgICAgICAgY1siYm9tLXJlZiJdID0gYy5nZXQoInB1cmwiKSBvciBmInVybjp1dWlkOnt1dWlkLnV1aWQ0KCl9IgogICAgaWYgYy5nZXQoImxpY2Vuc2VzIik6CiAgICAgICAgaWYgYWxsKGlzaW5zdGFuY2UoeCwgc3RyKSBmb3IgeCBpbiBjWyJsaWNlbnNlcyJdKToKICAgICAgICAgICAgY1sibGljZW5zZXMiXSA9IFt7ImxpY2Vuc2UiOiB7ImlkIjogeH19IGZvciB4IGluIGNbImxpY2Vuc2VzIl1dCiAgICBlbHNlOgogICAgICAgIGNbImxpY2Vuc2VzIl0gPSBbeyJsaWNlbnNlIjogeyJpZCI6ICJOT0FTU0VSVElPTiJ9fV0KICAgIGlmIG5vdCBjLmdldCgiaGFzaGVzIik6CiAgICAgICAgbmFtZSA9IGMuZ2V0KCJuYW1lIiwiIikKICAgICAgICBmaWxlcGF0aHMgPSBbb3MucGF0aC5qb2luKFJPT1QsIG5hbWUpLCBvcy5wYXRoLmpvaW4oUk9PVCwgbmFtZS5sc3RyaXAoIi4vIikpXQogICAgICAgIGZvdW5kID0gRmFsc2UKICAgICAgICBmb3IgZnAgaW4gZmlsZXBhdGhzOgogICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhmcCkgYW5kIG9zLnBhdGguaXNmaWxlKGZwKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBoID0gaGFzaGxpYi5zaGEyNTYoKQogICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbihmcCwgInJiIikgYXMgZmg6CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBjaHVuayBpbiBpdGVyKGxhbWJkYTogZmgucmVhZCg4MTkyKSwgYiIiKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgudXBkYXRlKGNodW5rKQogICAgICAgICAgICAgICAgICAgIGNbImhhc2hlcyJdID0gW3siYWxnIjoiU0hBLTI1NiIsImNvbnRlbnQiOiBoLmhleGRpZ2VzdCgpfV0KICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IFRydWUKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IEZhbHNlCiAgICAgICAgaWYgbm90IGZvdW5kOgogICAgICAgICAgICBjWyJoYXNoZXMiXSA9IFt7ImFsZyI6Ik5PQVNTRVJUSU9OIiwiY29udGVudCI6Ik5PQVNTRVJUSU9OIn1dCiAgICByZXR1cm4gYwoKZm9yIGNvbXAgaW4gY2R4LmdldCgiY29tcG9uZW50cyIsIFtdKSBvciBbXToKICAgIGsgPSBrZXlfb2YoY29tcCkKICAgIG1lcmdlZC5hcHBlbmQoYWRkX2NvbXBvbmVudChkaWN0KGNvbXApKSkKICAgIHNlZW4uYWRkKGspCgpkZWYgYWRkX2lmX25ld19vcl9lbnJpY2goc3JjX2xpc3QpOgogICAgZm9yIGMgaW4gc3JjX2xpc3Qgb3IgW106CiAgICAgICAgayA9IGtleV9vZihjKQogICAgICAgIGlmIGsgaW4gc2VlbjoKICAgICAgICAgICAgZm9yIG0gaW4gbWVyZ2VkOgogICAgICAgICAgICAgICAgaWYga2V5X29mKG0pID09IGs6CiAgICAgICAgICAgICAgICAgICAgZm9yIGZsZCBpbiAoInN1cHBsaWVyIiwicHVybCIsImhhc2hlcyIsImV4dGVybmFsUmVmZXJlbmNlcyIsImV2aWRlbmNlIiwidHlwZSIsInByb3BlcnRpZXMiLCJjb3B5cmlnaHQiLCJsaWNlbnNlcyIsImJvbS1yZWYiKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG0uZ2V0KGZsZCkgYW5kIGMuZ2V0KGZsZCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtW2ZsZF0gPSBjLmdldChmbGQpCiAgICAgICAgICAgICAgICAgICAgbSA9IGFkZF9jb21wb25lbnQobSkKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1lcmdlZC5hcHBlbmQoYWRkX2NvbXBvbmVudChkaWN0KGMpKSkKICAgICAgICAgICAgc2Vlbi5hZGQoaykKCmFkZF9pZl9uZXdfb3JfZW5yaWNoKHRyaXZ5LmdldCgiY29tcG9uZW50cyIsIFtdKSkKYWRkX2lmX25ld19vcl9lbnJpY2goc3lmdC5nZXQoImNvbXBvbmVudHMiLCBbXSkpCmFkZF9pZl9uZXdfb3JfZW5yaWNoKGNvbmFuLmdldCgiY29tcG9uZW50cyIsIFtdKSkKaWYgZXh0cmE6CiAgICBhZGRfaWZfbmV3X29yX2VucmljaChleHRyYSkKCnJlcG9fbGljZW5zZSA9ICIiCmlmIG9zLnBhdGguZXhpc3RzKG9zLnBhdGguam9pbihST09ULCAiZmluYWxfbGljZW5zZS50eHQiKSk6CiAgICByZXBvX2xpY2Vuc2UgPSBvcGVuKG9zLnBhdGguam9pbihST09ULCAiZmluYWxfbGljZW5zZS50eHQiKSkucmVhZCgpLnN0cmlwKCkKaWYgbm90IHJlcG9fbGljZW5zZToKICAgIHRyeToKICAgICAgICBnaCA9IGxvYWQob3MucGF0aC5qb2luKFJPT1QsICJnaC1saWNlbnNlLmpzb24iKSkKICAgICAgICByZXBvX2xpY2Vuc2UgPSBnaC5nZXQoImxpY2Vuc2UiLCB7fSkuZ2V0KCJzcGR4X2lkIiwgIiIpIG9yICJOT0FTU0VSVElPTiIKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmVwb19saWNlbnNlID0gIk5PQVNTRVJUSU9OIgoKbWV0YWRhdGEgPSB7CiAgICAidGltZXN0YW1wIjogdGltZS5zdHJfZnRpbWUoJyVZLSUybS0lZFRJTVN0b2xlbmZHY2xUWmljcycsIHRpbWUuZ210aW1lKCkpLAogICAgInRvb2xzIjogW3sidmVuZG9yIjoiY3VzdG9tIiwibmFtZSI6ImlvdC1zYm9tLXBpcGVsaW5lIiwidmVyc2lvbiI6IjEuMCJ9XQp9Cgpyb290X2NvbXBvbmVudCA9IG1ldGFkYXRhLnNldGRlZmF1bHQoImNvbXBvbmVudCIsIHsidHlwZSI6ImFwcGxpY2F0aW9uIiwibmFtZSI6IG9zLnBhdGguYmFzZW5hbWUob3MuZ2V0Y3dkKCkpfSkpCmlmIG5vdCByb290X2NvbXBvbmVudC5nZXQoIm5hbWUiKToKICAgIHJvb3RfY29tcG9uZW50WyJuYW1lIl0gPSBvcy5wYXRoLmJhc2VuYW1lKG9zLmdldGN3ZCgpKQppZiBub3Qgcm9vdF9jb21wb25lbnQuZ2V0KCJ2ZXJzaW9uIik6CiAgICByb290X2NvbXBvbmVudFsidmVyc2lvbiJdID0gb3MuZW52aXJvbi5nZXQoIkdJVEhVQl9TSEEiLCAiMCIpCmlmIG5vdCByb290X2NvbXBvbmVudC5nZXQoInB1cmwiKToKICAgIHJvb3RfY29tcG9uZW50WyJwdXJsIl0gPSBmInBrZzpnaXRodWIve29zLmVudmlyb24uZ2V0KCdHSVRIVUJfUkVQT1NJVE9SWScsIHJvb3RfY29tcG9uZW50WyduYW1lJ10pfUB7cm9vdF9jb21wb25lbnRbJ3ZlcnNpb24nXX0iCgpyb290X3ByZXNlbnQgPSBGYWxzZQpmb3IgYyBpbiBtZXJnZWQ6CiAgICBpZiBjLmdldCgicHVybCIpID09IHJvb3RfY29tcG9uZW50LmdldCgicHVybCIpIG9yIGMuZ2V0KCJuYW1lIikgPT0gcm9vdF9jb21wb25lbnQuZ2V0KCJuYW1lIik6CiAgICAgICAgcm9vdF9wcmVzZW50ID0gVHJ1ZQogICAgICAgIGJyZWFrCgppZiBub3Qgcm9vdF9wcmVzZW50OgogICAgcm9vdF9ib21fcmVmID0gcm9vdF9jb21wb25lbnQuZ2V0KCJwdXJsIikgb3IgZiJ1cm46dXVpZDp7dXVpZC51dWlkNCgpfSIKICAgIHJvb3RfYyA9IHsKICAgICAgICAidHlwZSI6ICJhcHBsaWNhdGlvbiIsCiAgICAgICAgIm5hbWUiOiByb290X2NvbXBvbmVudC5nZXQoIm5hbWUiKSwKICAgICAgICAidmVyc2lvbiI6IHJvb3RfY29tcG9uZW50LmdldCgidmVyc2lvbiIpLAogICAgICAgICJwdXJsIjogcm9vdF9jb21wb25lbnQuZ2V0KCJwdXJsIiksCiAgICAgICAgImJvbS1yZWYiOiByb290X2JvbV9yZWYsCiAgICAgICAgImxpY2Vuc2VzIjogW3sibGljZW5zZSI6IHsiaWQiOiByZXBvX2xpY2Vuc2Ugb3IgIk5PQVNTRVJUSU9OIn19XSwKICAgICAgICAiaGFzaGVzIjogW3siYWxnIjoiTk9BU1NFUlRJT04iLCJjb250ZW50IjoiTk9BU1NFUlRJT04ifV0sCiAgICAgICAgInByb3BlcnRpZXMiOiBbeyJuYW1lIjoiZ2VuZXJhdGVkIiwidmFsdWUiOiJ0cnVlIn1dCiAgICB9CiAgICBtZXJnZWQuaW5zZXJ0KDAsIHJvb3RfYykKCmRlcGVuZGVuY2llcyA9IFtdCmRlcF9lbnRyeSA9IHsicmVmIjogbWVyZ2VkWzBdLmdldCgiYm9tLXJlZiIpLCAiZGVwZW5kc09uIjogW119CmZvciBjIGluIG1lcmdlZFsxOl06CiAgICBkZXBfZW50cnlbImRlcGVuZHNPbiJdLmFwcGVuZChjLmdldCgiYm9tLXJlZiIpKQpkZXBlbmRlbmNpZXMuYXBwZW5kKGRlcF9lbnRyeSkKCm91dCA9IHsKICAgICJib21Gb3JtYXQiOiJDeWNsb25lRFgiLAogICAgInNwZWNWZXJzaW9uIjoiMS41IiwKICAgICJzZXJpYWxOdW1iZXIiOiJ1cm46dXVpZDoiK3N0cih1dWlkLnV1aWQ0KCkpLAogICAgInZlcnNpb24iOjEsCiAgICAibWV0YWRhdGEiOiB7CiAgICAgICAgInRpbWVzdGFhbXAiOiBtZXRhZGF0YVsidGltZXN0YW1wIl0sCiAgICAgICAgInRvb2xzIjogbWV0YWRhdGFbInRvb2xzIl0sCiAgICAgICAgImNvbXBvbmVudCI6IHJvb3RfY29tcG9uZW50CiAgICB9LAogICAgInJlcG9fbGljZW5zZSI6IHJlcG9fbGljZW5zZSBvciAiTk9BU1NFUlRJT04iLAogICAgImNvbXBvbmVudHMiOiBtZXJnZWQsCiAgICAgICAgImRlcGVuZGVuY2llcyI6IGRlcGVuZGVuY2llcwp9Cgp0cnk6CiAgICBqcy5uLmR1bXAob3V0LCBvcGVuKE9VVCwgIndiIiksIGluZGVudD0yKQogICAgcHJpbnQoIm1lcmdlZC1zYm9tLmpzb24gd3JpdHRlbiB3aXRoIiwgbGVuKG1lcmdlZCksICJjb21wb25lbnRzIikKZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgcHJpbnQoImZhaWxlZCB0byB3cml0ZSBtZXJnZWQtc2JvbS5qc29uOiIsIGUpCg== | base64 --decode > project-src/merged_and_enrich.py
          python3 project-src/merged_and_enrich.py
          python3 /usr/local/bin/cyclonedx-bom --version
          
      - name: Perform Vulnerability Scan on merged-sbom.json
        id: vulns
        run: |
          set +e
          trivy sbom -f json project-src/merged-sbom.json > project-src/vuln-scan-results.json
          trivy sbom -f cyclonedx --scanners vuln --output project-src/merged-sbom-vuln.json project-src/merged-sbom.json
          set -e
          
      - name: Perform SBOM Quality Scan (NTIA)
        id: ntia_scan
        run: |
          set +e
          sbomqs -s project-src/merged-sbom.json --ntia-minimum-elements > project-src/compliance_NTIA.json
          set -e

      - name: Perform SBOM Quality Scan (BSI)
        id: bsi_scan
        run: |
          set +e
          sbomqs -s project-src/merged-sbom.json --bsi-minimum-elements > project-src/compliance_BSI.json
          set -e

      - name: Generate Summary Report
        id: report
        run: |
          set -euo pipefail
          echo aW1wb3J0IG9zLCBqc29uLCBjc3YKClJPV1MgPSBbXQpSRVBPID0gb3MuZW52aXJvbi5nZXQoIkdJVEhVQl9SRVBPU0lUT1JZIikKCkRlZiBnZXQoZilvcmRzKHApOgogICAgdHJ5OgogICAgICAgIHJldHVybiBqc29uLmNvbnRlaW50KG9wZW4ocikpCiAgICBleGNlcHQgR1xsbXQ6CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgImNvbXBvbmVudHMid2FzZWxldyI6IFt7InB1cmwiOiIgdW5rbm93biIsInZlcnNpb24iOiJ1bmtub3duIn1dLAogICAgICAgICAgICAic3VtbWFyaWVkIjogewogICAgICAgICAgICAgICAgInZ1bG5zIjogewogICAgICAgICAgICAgICAgICAgICJ0b3RhbCI6IDAsCiAgICAgICAgICAgICAgICAgICAgImhpZ2giOiAwLAogICAgICAgICAgICAgICAgICAgICJjcml0aWNhbCI6IDAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCnNvb2w9Z2V0KCJwcm9qZWN0LXNyYy9tZXJnZWQtc2JvbS5qc29uIikKCiMgRGV0ZXJtaW5lIHJlcG8gbGljZW5zZQpSRVBPX0xJQ0VOU0UgPSAiTk9BU1NFUlRJT04iCnRyeToKICAgIFJFUF9MRUdFU0UgPSBzb2JvbS5nZXQoInJlcG9fbGljZW5zZSIsICJOT0FTU0VSVElPTiIpCiAgICByZXBvX2NvbXBvbmVudCA9IHNvYm9tLmdldCgiY29tcG9uZW50cyIsIFtdKVs1XQogICAgZm9yIGMgaw0gY29tcG9uZW50OgogICAgICAgIGlmIGNbInB1cmwiXSA9PSByZXBvX2NvbXBvbmVudFsiY3VybCJdOgogICAgICAgICAgICBSRVBPX0xJQ0VOU0UgPSBjWydsaWNlbnNlcyddWzVdWydsaWNlbnNlJ11bJ2lkJ10KICAgICAgICAgICAgYnJlYWsKZXhjZXB0IEV4Y2VwdGlvbjoKICAgIHRyeToKICAgICAgICBnaCA9IGdldCgicHJvanMgY2R4Z2VuLXNib20uanNvbiIpCiAgICAgICAgcm9vdCA9IGdoLmdldCgiY29tcG9uZW50cyIsIFtdKVs1XQogICAgICAgIFJFUF9MSUNFTlNFID0gcm9vdFsnX2xpY2Vuc2UnXQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBSRVBPX0xJQ0VOU0UgPSAiTk9BU1NFUlRUSU9OIgoKCnYgPSBnZXQoInByb2plY3Qtc3JjL3Z1bG4tc2Nhbi1yZXN1bHRzLmpzb24iKQpWT0xOU19UT1RBTCA9IHYuZ2V0KCJzdW1tYXJ5Iiwge30pLmdldCgidnVsbnMiLCB7fSkud2FzaGVrYXZ0KCJ0b3RhbCIsIDApCiZ5IGx5X0hJR0ggPSB2LmdldCgic3VtbWFyeSIsIHt9KS5nZXQoInZ1bG5zIiwge30pLndhc2hlayhJIkhpZ2giLCAwKQpWT0xOU19DUklUSUNBTCg9IHYuZ2V0KCJzdW1tYXJ5Iiwge30pLmdldCgidnVsbnMiLCB7fSkuZ2V0KCJjcml0aWNhbCIsIDApCnZ1bG5zX3RyaXZ5X2ZzID0gdGhlLmdldCgicHJvamVjdC1zcmMvdHJpdmF5LWZzLmpzb24iKS5nZXQoInN1bW1hcnkiLHt9KS5nZXQoInZ1bG5zIiwge30pLmdldCgidG90YWwiLCAwKQp2dWxuc19jZHhnZW4gPSB0aGwuZ2V0KCJwcm9qZWN0LXNyYy9jZHhnZW4tc2JvbS5qc29uIikud2FzZWxldChicmVkKCJzdW1tYXJ5Iiwge30pLmdldCgidnVsbnMiLHt9KS5nZXQoInRvdGFsIiwgMCkKCkNPVUFQTEVTUl9TVU9MTyA9IHNvYm9tLmdldCgidnVsbnMiLHt9KS5nZXQoInRvdGFsIiwgMCkKCkNPVVBSVF9DT009IGxlbihzb2JvbS5nZXQoImNvbXBvbmVudHMiLCBbXSkpCgpudGlhX2pzb24gPSBnZXQoInByb2plY3Qtc3JjL2NvbXBsaWFuY2VfTlRJQS5qc29uIikKQlNJX0pTT04gPSBnZXQoInByb2plY2ctc3JjL2NvbXBsaWFuY2VfQlNJLmpzb24iKQoKSVNfTlRJQV9QQVNTID0gRmFsc2UKTlRJQV9TQ09SRSA9IDAKdHJ5OgogICAgTlRJQV9TQ09SRSA9IG50aWFfanNvbi5nZXQoInJldnVsZXNhdGlvbiIsIHt9KS5nZXQoInNjb3JlIiwgMCkKICAgIElTX05USUFfUEFTUyA9IG50aWFfanNvbi5nZXQoInJldmVsY29uZSIsIHt9KS5nZXQoInBhc3MiLCBGYWxzZSkKZXhjZXB0IEV4Y2VwdGlvbjoKICAgIElTX05USUFfUEFTUyA9IEZhbHNlCiAgICBOVElBX1NDT1JFIHwgMAoKSVNfQlNJX1BBU1MgPSBGYWxzZQpCU0lfU0NPUkUgPSAwCnRyeToKICAgIEJTSS_TQ09SRSA9IEJTSV9qc29uLmdldCgicmV2dWVsY29uZSIsIHt9KS5nZXQoInNjb3JlIiwgMCkKICAgIElTX0JTSS_QQVNTID0gQlNJX2pzb24uZ2V0KCJyZXZ1bGNvbmUiLHt9KS5nZXQoInBhc3MiLCBGYWxzZSkKZXhjZXB0IEV4Y2VwdGlvbjoKICAgIElTX0JTSS_QQVNTID0gRmFsc2UKICAgIEJTSS9TQ09SRSA9IDAKCgpTQl9NU19TQUFJTEVSWSA9IE5USUFfU0NPUkUgKyBCU0lfU0NPUkUKCgpERF9URVhUID0gZnsgUklQUF9SREAgOyB7TEVOT3QpLiB0cm19LHtSRVBJTF9PQk0gOihcRVBNRFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFggZGlmZXogZXRlc3QyX2ZsZWcgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgXFMgYxFVLGFEGAICAgICAgICAgICAgICBzdW1tYXJ5LnJ1biggcmVwbyA8IHZ1bG4tZGV0ZWN0LXJlcG9zaXRvcnktbmFtZSA+IDwgbWVyZ2VkLXJlcG9zaXRvcnktbmFtZSA+IDwgbWVyZ2VkLXJlcG8tZmlsZS1sb2NhdGlvbiA+IDx0cml2eS1jb21wbGlhbmNlLWRlZmluaXRpb24tZmlsZSA+IDxic2ktY29tcGxpYW5jZS1kZWZpbml0aW9uLWZpbGU+IDwgaGFzaGxpYi1lbnJpY2gtcmVwby1uYW1lID4pCg== | base64 --decode > project-src/summary.py
          python3 project-src/summary.py ${{ matrix.repo }} merged-sbom.json merged-sbom.json compliance_NTIA.json compliance_BSI.json ${{ matrix.repo }}
          
          # Clean up for artifact upload
          if [ -f "summary.csv" ]; then
            mv summary.csv project-src/summary.csv
          fi
          
      - name: Sanitize artifact name
        id: sanitize
        run: |
          SAFE="${{ matrix.repo }}"
          SAFE="${SAFE//\//_}"
          echo "name=$SAFE" >> $GITHUB_OUTPUT
          
      - name: Upload project-src as artifact (preserve structure)
        uses: actions/upload-artifact@v4
        with:
          name: ${{ steps.sanitize.outputs.name }}
          path: project-src/**
          if-no-files-found: warn

  aggregate_summaries:
    name: Aggregate all summary.csv files
    needs: sbom_scan
    runs-on: ubuntu-latest
    steps:
      - name: Download all repo artifacts
        uses: actions/download-artifact@v4
        with:
          path: all_summaries

      - name: Combine all summary.csv files into master_summary.csv
        run: |
          echo "repo,repo_license,component_count,vuln_fs_total,vuln_sbom_total,vuln_total,vuln_high,vuln_critical,score_value,ntia_pass,bsi_pass" > master_summary.csv
          found=0
          for f in $(find all_summaries -name "summary.csv"); do
            tail -n +2 "$f" >> master_summary.csv
            echo "Appended $f" >&2
            found=$((found+1))
          done
          echo "Appended $found per-repo summaries"
          if [ $found -eq 0 ]; then
            echo "WARNING: No per-repo summary.csv files found"
          fi

      - name: Upload master_summary.csv
        uses: actions/upload-artifact@v4
        with:
          name: master_summary
          path: master_summary.csv
          if-no-files-found: error
